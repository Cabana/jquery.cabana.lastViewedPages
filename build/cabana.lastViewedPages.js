function localStorageSetObject(a,d){localStorage.setItem(a,JSON.stringify(d))}function localStorageGetObject(a){return(a=localStorage.getItem(a))&&JSON.parse(a)}Array.prototype.filter||(Array.prototype.filter=function(a){for(var d=[],b=0;b<this.length;b++)a(this[b])&&d.push(this[b]);return d});
var LastViewedPages=function(){function a(a){a=a||{};this.pages=a.pages||[];this.max=a.max||10;this.localStorageId="lastViewedPages";localStorageSetObject(this.localStorageId,this.pages)}a.prototype.all=function(){return this.pages};a.prototype.addPage=function(a){var b=this.pages.filter(function(b){return JSON.stringify(b)!=JSON.stringify(a)});b.unshift(a);this.pages=b=b.slice(0,this.max);this._saveToLocalStorage()};a.prototype._saveToLocalStorage=function(){localStorageSetObject(this.localStorageId,
this.pages)};a.prototype.pagesSaved=function(){return 0<this.pages.length};return a}();
(function(a,d,b,f){var e=null;a.widget("cabana.lastViewedPages",{options:{count:10,markup:function(a){var c;c="<h1>Last viewed pages</h1><ul>";for(var b=0;b<a.length;b++){var d=a[b];c+="<li>";c+='<a href="'+d.url+'">';c+=d.title;c+="</a>";c+="</li>"}return c+="</ul>"},currentPage:{url:d.location.href,title:a("title").text()}},_create:function(){_this=this;_this._applyDataParams();e=_this._pagesSavedToLocalStorage()?new LastViewedPages({pages:localStorageGetObject("lastViewedPages"),max:_this.options.count}):
new LastViewedPages({max:_this.options.count});e.addPage(_this.options.currentPage);_this._render()},_applyDataParams:function(){this._applyDataParam("count","last-viewed-pages-count")},_applyDataParam:function(b,c){a(this.element).data(c)&&(this.options[b]=a(this.element).data(c))},_pagesSavedToLocalStorage:function(){return localStorageGetObject("lastViewedPages")&&localStorageGetObject("lastViewedPages").length},destroy:function(){this.element.html("");localStorageSetObject(e.localStorageId,[])},
clear:function(){e=new LastViewedPages({max:_this.options.count})},_render:function(){var a=this.options.markup(e.all());this.element.append(a)}})})(jQuery,window,document);
